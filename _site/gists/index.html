
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Youssef Sahli" />
    
      <link
        rel="stylesheet"
        type="text/css"
        href="/static/css/pico.orange.css"
      />
    
      <link
        rel="stylesheet"
        type="text/css"
        href="/static/css/within.min.css"
      />
    
      <link
        rel="stylesheet"
        type="text/css"
        href="/static/css/typography-setup.css"
      />
    
      <link
        rel="stylesheet"
        type="text/css"
        href="/static/css/prism-laserwave.css"
      />
    
  </head>
  <body>
    
      <div style="text-align:center;margin-top:40px;">
        <hgroup><span class="title">Gists</span></hgroup>
      </div>
    
    <header class="container" style="width: 550px;padding-bottom:0;">
      
    </header>
    <main class="container-fluid" style="padding-top:0;" data-pagefind-body>
      <hr />
      <div>

<details>
  <summary>Textadept: Outlining code using ctags</summary>
  <main>
    <code class="language-Lua" style="white-space: pre-line">
      <pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> ctags <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">make_ctags</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> source<span class="token punctuation">)</span>
	ui<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"----[generating ctags...]----"</span><span class="token punctuation">)</span>
	<span class="token keyword">local</span> dir<span class="token punctuation">,</span> _ <span class="token operator">=</span> <span class="token function">split</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
	<span class="token keyword">local</span> tags_filepath <span class="token operator">=</span> dir <span class="token operator">..</span> <span class="token string">"/tags"</span>
	<span class="token keyword">local</span> cmd <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'ctags -f %s %s'</span><span class="token punctuation">,</span> tags_filepath<span class="token punctuation">,</span> source<span class="token punctuation">)</span>
	ui<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Executing command:"</span><span class="token punctuation">,</span> cmd<span class="token punctuation">)</span>
  <span class="token keyword">local</span> success<span class="token punctuation">,</span> type<span class="token punctuation">,</span> code <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token keyword">not</span> success <span class="token keyword">then</span>
			ui<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ctags command failed with type:"</span><span class="token punctuation">,</span> type<span class="token punctuation">,</span> <span class="token string">"and code:"</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span>
	<span class="token keyword">else</span>
		ui<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"generating ctags success"</span><span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">parse_ctags</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> source<span class="token punctuation">,</span> force_gen<span class="token punctuation">)</span>
	ui<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"------[Parsing]------"</span><span class="token punctuation">)</span>
  <span class="token keyword">local</span> tags <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span> force_gen <span class="token keyword">or</span> <span class="token keyword">not</span> lfs<span class="token punctuation">.</span><span class="token function">attributes</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> <span class="token keyword">then</span>
		<span class="token function">make_ctags</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> source<span class="token punctuation">)</span>
	<span class="token keyword">end</span>

  <span class="token keyword">local</span> tag_file<span class="token punctuation">,</span> err <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
	<span class="token keyword">local</span> dir<span class="token punctuation">,</span> _ <span class="token operator">=</span> <span class="token function">split</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>

	<span class="token keyword">if</span> <span class="token keyword">not</span> tag_file <span class="token keyword">then</span>  <span class="token comment">-- Error check</span>
        ui<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Error opening ctags file:"</span><span class="token punctuation">,</span> file_path<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span> tags
    <span class="token keyword">end</span>

  <span class="token keyword">for</span> line <span class="token keyword">in</span> tag_file<span class="token punctuation">:</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token keyword">if</span> line<span class="token punctuation">:</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"!"</span> <span class="token keyword">then</span>
      <span class="token comment">-- Skip lines starting with '!'</span>
      <span class="token keyword">goto</span> continue
    <span class="token keyword">end</span>

    <span class="token keyword">local</span> name<span class="token punctuation">,</span> file<span class="token punctuation">,</span> pattern <span class="token operator">=</span> line<span class="token punctuation">:</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">"^(%S+)\t(%S+)\t/(.-)%$/;"</span><span class="token punctuation">)</span>
		<span class="token comment">--if not (name and file and pattern) then</span>
		<span class="token comment">--	ui.print("Failed to match:", line)</span>
		<span class="token comment">--end</span>
    <span class="token keyword">if</span> name <span class="token keyword">and</span> file <span class="token keyword">and</span> pattern <span class="token keyword">then</span>
      table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>tags<span class="token punctuation">,</span> <span class="token punctuation">{</span>name <span class="token operator">=</span> name<span class="token punctuation">,</span> file <span class="token operator">=</span> file<span class="token punctuation">,</span> pattern <span class="token operator">=</span> pattern<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    <span class="token punctuation">::</span>continue<span class="token punctuation">::</span>
  <span class="token keyword">end</span>

  tag_file<span class="token punctuation">:</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> tags
<span class="token keyword">end</span>


<span class="token keyword">function</span> ctags<span class="token punctuation">.</span><span class="token function">select_symbol</span><span class="token punctuation">(</span>force_gen<span class="token punctuation">)</span>
	<span class="token keyword">local</span> dir<span class="token punctuation">,</span> file <span class="token operator">=</span> <span class="token function">split</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">local</span> tpath <span class="token operator">=</span> dir<span class="token operator">..</span><span class="token string">"/tags"</span>
	<span class="token keyword">local</span> tags <span class="token operator">=</span> <span class="token function">parse_ctags</span><span class="token punctuation">(</span>tpath<span class="token punctuation">,</span> buffer<span class="token punctuation">.</span>filename<span class="token punctuation">,</span> force_gen<span class="token punctuation">)</span>
	<span class="token keyword">local</span> items <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> _<span class="token punctuation">,</span> tag <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>tags<span class="token punctuation">)</span> <span class="token keyword">do</span>
		table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>items<span class="token punctuation">,</span> tag<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	<span class="token keyword">end</span>

	<span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">#</span>items<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"no ctags found."</span><span class="token punctuation">)</span>

	<span class="token keyword">local</span> choice <span class="token operator">=</span> ui<span class="token punctuation">.</span>dialogs<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">{</span>
		title <span class="token operator">=</span> <span class="token string">"Select Symbol"</span><span class="token punctuation">,</span>
		items <span class="token operator">=</span> items<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> choice <span class="token keyword">then</span>

		<span class="token keyword">local</span> tag <span class="token operator">=</span> tags<span class="token punctuation">[</span>choice<span class="token punctuation">]</span>
		<span class="token keyword">local</span> tfile<span class="token punctuation">,</span> err <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span>file<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> tfile <span class="token keyword">then</span>
			ui<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"error opening file: "</span><span class="token operator">..</span>tag<span class="token punctuation">.</span>file<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">end</span>
		<span class="token keyword">local</span> lineno <span class="token operator">=</span> <span class="token number">0</span>

		<span class="token comment">-- Extract and escape the relevant part of the pattern</span>
		<span class="token keyword">local</span> epatt <span class="token operator">=</span> tag<span class="token punctuation">.</span>pattern<span class="token punctuation">:</span><span class="token function">gsub</span><span class="token punctuation">(</span><span class="token string">'([%(%)%.%%%+%-%*%?%[%^%$])'</span><span class="token punctuation">,</span> <span class="token string">'%%%1'</span><span class="token punctuation">)</span>
		epatt <span class="token operator">=</span> epatt<span class="token punctuation">:</span><span class="token function">gsub</span><span class="token punctuation">(</span><span class="token string">"^%%^"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span> line <span class="token keyword">in</span> tfile<span class="token punctuation">:</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
			lineno <span class="token operator">=</span> lineno <span class="token operator">+</span> <span class="token number">1</span>
			<span class="token keyword">if</span> line<span class="token punctuation">:</span><span class="token function">match</span><span class="token punctuation">(</span>epatt<span class="token punctuation">)</span> <span class="token keyword">then</span>
        <span class="token keyword">break</span>
			<span class="token keyword">end</span>
		<span class="token keyword">end</span>
		tfile<span class="token punctuation">:</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

		<span class="token comment">-- Open the file and navigate to the symbol's line</span>
		io<span class="token punctuation">.</span><span class="token function">open_file</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span>file<span class="token punctuation">)</span>
		buffer<span class="token punctuation">:</span><span class="token function">goto_line</span><span class="token punctuation">(</span>lineno<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">return</span> ctags</code></pre>
    </code>
  </main>
</details>

<details>
  <summary>Lua Minimal Vector Lib (2D)</summary>
  <main>
    <code class="language-Lua" style="white-space: pre-line">
      <pre class="language-lua"><code class="language-lua"><span class="token comment">-- Vector Library</span>

<span class="token keyword">local</span> vec <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">-- Create the vector table</span>

<span class="token comment">-- Define the new function within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    x <span class="token operator">=</span> x <span class="token keyword">or</span> <span class="token number">0</span>
    y <span class="token operator">=</span> y <span class="token keyword">or</span> <span class="token number">0</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span> <span class="token keyword">and</span> <span class="token function">type</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span><span class="token punctuation">,</span> <span class="token string">"x and y must be numbers"</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">}</span>
    <span class="token function">setmetatable</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> self<span class="token punctuation">)</span>  <span class="token comment">-- Set the metatable to vec</span>
    self<span class="token punctuation">.</span>__index <span class="token operator">=</span> self  <span class="token comment">-- Set the index to the table itself</span>
    <span class="token keyword">return</span> t
<span class="token keyword">end</span>

<span class="token comment">-- Define the type method within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"vector"</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the dot product function within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">dot</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> v1<span class="token punctuation">.</span>x <span class="token operator">*</span> v2<span class="token punctuation">.</span>x <span class="token operator">+</span> v1<span class="token punctuation">.</span>y <span class="token operator">*</span> v2<span class="token punctuation">.</span>y
<span class="token keyword">end</span>

<span class="token comment">-- Define the __div metamethod</span>
<span class="token keyword">function</span> vec<span class="token punctuation">.</span><span class="token function">__div</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span><span class="token punctuation">,</span> <span class="token string">"divisor should be a number"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x <span class="token operator">/</span> b<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y <span class="token operator">/</span> b<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the __mul metamethod</span>
<span class="token keyword">function</span> vec<span class="token punctuation">.</span><span class="token function">__mul</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>x <span class="token operator">*</span> a<span class="token punctuation">,</span> b<span class="token punctuation">.</span>y <span class="token operator">*</span> a<span class="token punctuation">)</span>
    <span class="token keyword">elseif</span> <span class="token function">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x <span class="token operator">*</span> b<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y <span class="token operator">*</span> b<span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> a<span class="token punctuation">:</span><span class="token function">dot</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the __unm metamethod</span>
<span class="token keyword">function</span> vec<span class="token punctuation">.</span><span class="token function">__unm</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">-</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>v<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the __add metamethod</span>
<span class="token keyword">function</span> vec<span class="token punctuation">.</span><span class="token function">__add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">getmetatable</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> vec <span class="token keyword">and</span> <span class="token function">getmetatable</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> vec<span class="token punctuation">,</span> <span class="token string">"can't add vec and non-vec"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x <span class="token operator">+</span> b<span class="token punctuation">.</span>x<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y <span class="token operator">+</span> b<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">.</span><span class="token function">__sub</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">getmetatable</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> vec <span class="token keyword">and</span> <span class="token function">getmetatable</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> vec<span class="token punctuation">,</span> <span class="token string">"can't subtract vec and non-vec"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x <span class="token operator">-</span> b<span class="token punctuation">.</span>x<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y <span class="token operator">-</span> b<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token keyword">end</span>


<span class="token comment">-- Define the __eq metamethod</span>
<span class="token keyword">function</span> vec<span class="token punctuation">.</span><span class="token function">__eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">==</span> b<span class="token punctuation">.</span>x <span class="token keyword">and</span> a<span class="token punctuation">.</span>y <span class="token operator">==</span> b<span class="token punctuation">.</span>y
<span class="token keyword">end</span>

<span class="token comment">-- Define the len method within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">*</span> self<span class="token punctuation">.</span>x <span class="token operator">+</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the norm method within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> length <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> self <span class="token operator">/</span> length
<span class="token keyword">end</span>

<span class="token comment">-- Define the __tostring metamethod</span>
<span class="token keyword">function</span> vec<span class="token punctuation">.</span><span class="token function">__tostring</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
    <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"&lt;%g, %g>"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the angle method within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">angle</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">local</span> dot_product <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">dot</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
    <span class="token keyword">local</span> mag_product <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> v<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> angle_rad <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span>dot_product <span class="token operator">/</span> mag_product<span class="token punctuation">)</span>
    <span class="token keyword">return</span> angle_rad <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">180</span> <span class="token operator">/</span> math<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>  <span class="token comment">-- Convert radians to degrees</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the direction method within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">direction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> angle_rad <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">atan2</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
    <span class="token keyword">return</span> angle_rad <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">180</span> <span class="token operator">/</span> math<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>  <span class="token comment">-- Convert radians to degrees</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the cross product method within the vec table</span>
<span class="token comment">-- return a scalar value of the z coord</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">cross</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>z <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> v<span class="token punctuation">.</span>z <span class="token operator">==</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> <span class="token string">"Cross product only defined for 2D vectors"</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> cross_z <span class="token operator">=</span> self<span class="token punctuation">.</span>x <span class="token operator">*</span> v<span class="token punctuation">.</span>y <span class="token operator">-</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> v<span class="token punctuation">.</span>x
    <span class="token keyword">return</span> cross_z
<span class="token keyword">end</span>

<span class="token comment">-- Define the projection method within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">project_onto</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">local</span> dot_product <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">dot</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
    <span class="token keyword">local</span> mag_square <span class="token operator">=</span> v<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token keyword">local</span> projection_scale <span class="token operator">=</span> dot_product <span class="token operator">/</span> mag_square
    <span class="token keyword">return</span> v <span class="token operator">*</span> projection_scale  <span class="token comment">-- Adjusted multiplication</span>
<span class="token keyword">end</span>

<span class="token comment">-- Define the rejection method within the vec table</span>
<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">reject_from</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">local</span> projection <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">project_onto</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">-</span> projection<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">-</span> projection<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">orientation</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token comment">-- Calculate the orientation of three vectors</span>
    <span class="token keyword">local</span> determinant <span class="token operator">=</span> self<span class="token punctuation">.</span>x <span class="token operator">*</span> v<span class="token punctuation">.</span>y <span class="token operator">-</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> v<span class="token punctuation">.</span>x
    <span class="token keyword">if</span> determinant <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token string">"counterclockwise"</span>
    <span class="token keyword">elseif</span> determinant <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token string">"clockwise"</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token string">"collinear"</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">triangle_area</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token comment">-- Calculate the area of a triangle formed by two vectors</span>
    <span class="token keyword">return</span> <span class="token number">0.5</span> <span class="token operator">*</span> math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token function">cross</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">perpendicular</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">-- Calculate the perpendicular vector</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">-</span>self<span class="token punctuation">.</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">polar_to_cartesian</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> theta<span class="token punctuation">)</span>
    <span class="token comment">-- Convert polar coordinates to Cartesian coordinates</span>
    <span class="token keyword">local</span> x <span class="token operator">=</span> r <span class="token operator">*</span> math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
    <span class="token keyword">local</span> y <span class="token operator">=</span> r <span class="token operator">*</span> math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">cartesian_to_polar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">-- Convert Cartesian coordinates to polar coordinates</span>
    <span class="token keyword">local</span> r <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> theta <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">atan2</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
    <span class="token keyword">return</span> r<span class="token punctuation">,</span> theta
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">vector_area</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token comment">-- Calculate the signed area of a polygon defined by a set of vectors</span>
    <span class="token keyword">local</span> cross_product_sum <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">cross</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0.5</span> <span class="token operator">*</span> cross_product_sum
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">reflect_about_line</span><span class="token punctuation">(</span>normal_vector<span class="token punctuation">)</span>
    <span class="token comment">-- Reflect a vector about an arbitrary line defined by its normal vector</span>
    <span class="token keyword">local</span> projection <span class="token operator">=</span> self<span class="token punctuation">:</span><span class="token function">project_onto</span><span class="token punctuation">(</span>normal_vector<span class="token punctuation">)</span>
    <span class="token keyword">local</span> reflection <span class="token operator">=</span> self <span class="token operator">-</span> projection <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token keyword">return</span> reflection
<span class="token keyword">end</span>


<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">scale_by_components</span><span class="token punctuation">(</span>sx<span class="token punctuation">,</span> sy<span class="token punctuation">)</span>
    <span class="token comment">-- Scale a vector by different factors for its x and y components</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">*</span> sx<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> sy<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">displacement_to</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token comment">-- Calculate the displacement vector between two points defined by vectors</span>
    <span class="token keyword">local</span> dx <span class="token operator">=</span> v<span class="token punctuation">.</span>x <span class="token operator">-</span> self<span class="token punctuation">.</span>x
    <span class="token keyword">local</span> dy <span class="token operator">=</span> v<span class="token punctuation">.</span>y <span class="token operator">-</span> self<span class="token punctuation">.</span>y
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span>
<span class="token keyword">end</span>


<span class="token keyword">function</span> vec<span class="token punctuation">:</span><span class="token function">midpoint</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token comment">-- Calculate the midpoint of a vector (considering it as a line segment)</span>
    <span class="token keyword">local</span> mid_x <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> v<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token keyword">local</span> mid_y <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>y <span class="token operator">+</span> v<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token keyword">return</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>mid_x<span class="token punctuation">,</span> mid_y<span class="token punctuation">)</span>
<span class="token keyword">end</span>


<span class="token comment">-- Testing function</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">VecTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> vec1 <span class="token operator">=</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> vec2 <span class="token operator">=</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
		<span class="token keyword">local</span> vec3 <span class="token operator">=</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Testing Vector Library"</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector 1:"</span><span class="token punctuation">,</span> vec1<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector 2:"</span><span class="token punctuation">,</span> vec2<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector 1 Type:"</span><span class="token punctuation">,</span> vec1<span class="token punctuation">:</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">local</span> sum <span class="token operator">=</span> vec1 <span class="token operator">+</span> vec2
    <span class="token keyword">local</span> scaled <span class="token operator">=</span> vec1 <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token keyword">local</span> dotProduct <span class="token operator">=</span> vec1 <span class="token operator">*</span> vec2
    <span class="token keyword">local</span> normalized <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector Sum:"</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector Scaled:"</span><span class="token punctuation">,</span> scaled<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector Dot Product:"</span><span class="token punctuation">,</span> dotProduct<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector Normalized:"</span><span class="token punctuation">,</span> normalized<span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

		 <span class="token keyword">local</span> angle_deg <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">angle</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>
    <span class="token keyword">local</span> direction_deg <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">direction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Angle between vectors:"</span><span class="token punctuation">,</span> angle_deg<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Direction of vector 1:"</span><span class="token punctuation">,</span> direction_deg<span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

		<span class="token keyword">local</span> cross_product <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">cross</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>
    <span class="token keyword">local</span> projected_vec <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">project_onto</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>
    <span class="token keyword">local</span> rejected_vec <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">reject_from</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Cross Product:"</span><span class="token punctuation">,</span> cross_product<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Projected Vector:"</span><span class="token punctuation">,</span> projected_vec<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Rejected Vector:"</span><span class="token punctuation">,</span> rejected_vec<span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">-- Test angle calculation</span>
    <span class="token keyword">local</span> angle <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">angle</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Angle between vec1 and vec2:"</span><span class="token punctuation">,</span> angle<span class="token punctuation">)</span>

    <span class="token comment">-- Test direction calculation</span>
    <span class="token keyword">local</span> direction <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">direction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Direction of vec1:"</span><span class="token punctuation">,</span> direction<span class="token punctuation">)</span>

    <span class="token comment">-- Test vector area of polygon</span>
    <span class="token keyword">local</span> area <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">vector_area</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Vector area of polygon formed by vec1 and vec2:"</span><span class="token punctuation">,</span> area<span class="token punctuation">)</span>

    <span class="token comment">-- Test vector reflection about line</span>
    <span class="token keyword">local</span> normal_vector <span class="token operator">=</span> vec<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">local</span> reflected_vec <span class="token operator">=</span> vec3<span class="token punctuation">:</span><span class="token function">reflect_about_line</span><span class="token punctuation">(</span>normal_vector<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Reflected vector of vec3 about line:"</span><span class="token punctuation">,</span> reflected_vec<span class="token punctuation">)</span>

    <span class="token comment">-- Test vector scaling by components</span>
    <span class="token keyword">local</span> scaled_vec <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">scale_by_components</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Scaled vector of vec1 by components:"</span><span class="token punctuation">,</span> scaled_vec<span class="token punctuation">)</span>

    <span class="token comment">-- Test vector displacement between points</span>
    <span class="token keyword">local</span> displacement <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">displacement_to</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Displacement vector between vec1 and vec2:"</span><span class="token punctuation">,</span> displacement<span class="token punctuation">)</span>

    <span class="token comment">-- Test vector midpoint</span>
    <span class="token keyword">local</span> midpoint <span class="token operator">=</span> vec1<span class="token punctuation">:</span><span class="token function">midpoint</span><span class="token punctuation">(</span>vec2<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Midpoint between vec1 and vec2:"</span><span class="token punctuation">,</span> midpoint<span class="token punctuation">)</span>

    <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- Run the testing function</span>
<span class="token function">VecTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
    </code>
  </main>
</details>

<details>
  <summary>Lua Minimal Vector Lib (2D)</summary>
  <main>
    <code class="language-Lua" style="white-space: pre-line">
      <pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> vec <span class="token operator">=</span> <span class="token punctuation">{</span> new <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">=</span>x <span class="token keyword">or</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">=</span>y <span class="token keyword">or</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token function">setmetatable</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">;</span> _<span class="token punctuation">.</span>index <span class="token operator">=</span> _<span class="token punctuation">;</span> <span class="token keyword">return</span> t <span class="token keyword">end</span><span class="token punctuation">,</span> Type <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"vector"</span> <span class="token keyword">end</span><span class="token punctuation">,</span> D <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">*</span> b<span class="token punctuation">.</span>x <span class="token operator">+</span> a<span class="token punctuation">.</span>y <span class="token operator">*</span> b<span class="token punctuation">.</span>y <span class="token keyword">end</span><span class="token punctuation">,</span> __div <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> a<span class="token punctuation">.</span>x<span class="token operator">/</span>b<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y<span class="token operator">/</span>b<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __mul <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span> <span class="token keyword">then</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> b<span class="token punctuation">.</span>x<span class="token operator">*</span>a<span class="token punctuation">,</span> b<span class="token punctuation">.</span>y<span class="token operator">*</span>a<span class="token punctuation">)</span> <span class="token keyword">elseif</span> <span class="token function">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"number"</span> <span class="token keyword">then</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> a<span class="token punctuation">.</span>x<span class="token operator">*</span>b<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y<span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token keyword">return</span> a<span class="token punctuation">:</span><span class="token function">D</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token keyword">end</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __unm <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> <span class="token operator">-</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token operator">-</span>v<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __add <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">getmetatable</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> vec <span class="token keyword">and</span> <span class="token function">getmetatable</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> vec<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> a<span class="token punctuation">.</span>x<span class="token operator">+</span>b<span class="token punctuation">.</span>x<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y<span class="token operator">+</span>b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __eq <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">==</span> b<span class="token punctuation">.</span>x <span class="token keyword">and</span> a<span class="token punctuation">.</span>y <span class="token operator">==</span> b<span class="token punctuation">.</span>y <span class="token keyword">end</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token operator">*</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> self<span class="token punctuation">.</span>y<span class="token operator">*</span>self<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> norm <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token keyword">return</span> self <span class="token operator">/</span> self<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __tostring <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"&lt;%g, %g>"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">local</span> d <span class="token operator">=</span> a<span class="token punctuation">:</span><span class="token function">D</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">local</span> m <span class="token operator">=</span> a<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> b<span class="token punctuation">:</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">local</span> r <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span>d<span class="token operator">/</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> r <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">180</span><span class="token operator">/</span>math<span class="token punctuation">.</span>pi<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> direction <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">deg</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">atan2</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>y<span class="token punctuation">,</span> a<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> area <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">:</span><span class="token function">D</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.5</span> <span class="token keyword">end</span><span class="token punctuation">,</span> reflect <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> v <span class="token operator">-</span> <span class="token punctuation">(</span>v<span class="token punctuation">:</span><span class="token function">project</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>sx<span class="token punctuation">,</span>sy<span class="token punctuation">)</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> v<span class="token punctuation">.</span>x<span class="token operator">*</span>sx<span class="token punctuation">,</span> v<span class="token punctuation">.</span>y<span class="token operator">*</span>sy<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> displacement <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> b<span class="token punctuation">.</span>x<span class="token operator">-</span>a<span class="token punctuation">.</span>x<span class="token punctuation">,</span> b<span class="token punctuation">.</span>y<span class="token operator">-</span>a<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> midpoint <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token operator">+</span>b<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>y<span class="token operator">+</span>b<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __sub <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">getmetatable</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> vec <span class="token keyword">and</span> <span class="token function">getmetatable</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">==</span> vec<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> vec<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> a<span class="token punctuation">.</span>x<span class="token operator">-</span>b<span class="token punctuation">.</span>x<span class="token punctuation">,</span> a<span class="token punctuation">.</span>y<span class="token operator">-</span>b<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span> <span class="token punctuation">}</span></code></pre>
    </code>
  </main>
</details>

<details>
  <summary>Vector2D in Lua minimized</summary>
  <main>
    <code class="language-Lua" style="white-space: pre-line">
      <pre class="language-lua"><code class="language-lua">Vector2D <span class="token operator">=</span> <span class="token punctuation">{</span>new <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">setmetatable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x <span class="token operator">=</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>__index <span class="token operator">=</span> Vector2D<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __add <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span> <span class="token keyword">return</span> Vector2D<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span>x <span class="token operator">+</span> v2<span class="token punctuation">.</span>x<span class="token punctuation">,</span> v1<span class="token punctuation">.</span>y <span class="token operator">+</span> v2<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __sub <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span> <span class="token keyword">return</span> Vector2D<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span>x <span class="token operator">-</span> v2<span class="token punctuation">.</span>x<span class="token punctuation">,</span> v1<span class="token punctuation">.</span>y <span class="token operator">-</span> v2<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> __mul <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> scalar<span class="token punctuation">)</span> <span class="token keyword">return</span> Vector2D<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>x <span class="token operator">*</span> scalar<span class="token punctuation">,</span> v<span class="token punctuation">.</span>y <span class="token operator">*</span> scalar<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>x <span class="token operator">*</span> v<span class="token punctuation">.</span>x <span class="token operator">+</span> v<span class="token punctuation">.</span>y <span class="token operator">*</span> v<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> normalize <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">local</span> len <span class="token operator">=</span> v<span class="token punctuation">:</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">return</span> len <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">and</span> v <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> len<span class="token punctuation">)</span> <span class="token keyword">or</span> Vector2D<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> angle <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">atan2</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> v<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">}</span></code></pre>
    </code>
  </main>
</details>

<details>
  <summary>Perlin Lua</summary>
  <main>
    <code class="language-Lua" style="white-space: pre-line">
      <pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">mix</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> t<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>t <span class="token operator">*</span> <span class="token punctuation">(</span>b <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> a <span class="token keyword">end</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">mod</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">%</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> b <span class="token keyword">end</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">fract</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">return</span> x <span class="token operator">-</span> math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">end</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">clamp</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token keyword">end</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">dot</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">local</span> s <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">#</span>a <span class="token keyword">do</span>
        s <span class="token operator">=</span> s <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">end</span>
    <span class="token keyword">return</span> s
<span class="token keyword">end</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">sign</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">return</span> x <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token number">1</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">or</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">end</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">pow2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">sign</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">end</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">pal</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    i <span class="token operator">=</span> i <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">15</span> <span class="token keyword">and</span> <span class="token number">15</span> <span class="token keyword">or</span> i<span class="token punctuation">)</span>
    <span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> g <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> b <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
        <span class="token keyword">return</span> <span class="token function">peek</span><span class="token punctuation">(</span><span class="token number">0x3fc0</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               <span class="token function">peek</span><span class="token punctuation">(</span><span class="token number">0x3fc0</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               <span class="token function">peek</span><span class="token punctuation">(</span><span class="token number">0x3fc0</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span>
        <span class="token function">poke</span><span class="token punctuation">(</span><span class="token number">0x3fc0</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token function">clamp</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">poke</span><span class="token punctuation">(</span><span class="token number">0x3fc0</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">clamp</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">poke</span><span class="token punctuation">(</span><span class="token number">0x3fc0</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">clamp</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> seed <span class="token operator">=</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> <span class="token number">500</span> <span class="token operator">+</span> <span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1e4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    fx <span class="token operator">=</span> <span class="token number">500</span> <span class="token operator">+</span> <span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1e4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    fy <span class="token operator">=</span> <span class="token number">500</span> <span class="token operator">+</span> <span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1e4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    px <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
    py <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span>
<span class="token punctuation">}</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">pseudorandom2D</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">fract</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token function">dot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x <span class="token operator">+</span> seed<span class="token punctuation">.</span>px<span class="token punctuation">,</span> y <span class="token operator">+</span> seed<span class="token punctuation">.</span>py<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>seed<span class="token punctuation">.</span>fx<span class="token punctuation">,</span> seed<span class="token punctuation">.</span>fy<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> seed<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">perlin</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">mix</span><span class="token punctuation">(</span>
        <span class="token function">mix</span><span class="token punctuation">(</span>
            <span class="token function">pseudorandom2D</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">pseudorandom2D</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">fract</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">mix</span><span class="token punctuation">(</span>
            <span class="token function">pseudorandom2D</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">pseudorandom2D</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">fract</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">fract</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    x <span class="token operator">=</span> x <span class="token operator">/</span> <span class="token number">15</span>
    y <span class="token operator">=</span> y <span class="token operator">/</span> <span class="token number">15</span>
    <span class="token keyword">local</span> iterations <span class="token operator">=</span> <span class="token number">4</span>
    <span class="token keyword">local</span> sum <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> iterations <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">do</span>
        seed<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">500</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token function">fract</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">0.512</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">512</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">725.63</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1e4</span><span class="token punctuation">)</span>
        sum <span class="token operator">=</span> sum <span class="token operator">+</span> <span class="token function">perlin</span><span class="token punctuation">(</span>x <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
    <span class="token keyword">return</span> sum <span class="token operator">/</span> iterations
<span class="token keyword">end</span></code></pre>
    </code>
  </main>
</details>

</div>
    </main>

    <footer class="container">
      <div class="container">
        <hr />

        <div class="container" role="group">
          <div class="container">
            <nav
              aria-label="breadcrumb"
              style="--pico-nav-breadcrumb-divider:'·';font-family:Neon"
            >
              <ul class='breadcrumbs'> <li><a href="/"> @ </a></li><li>gists</li></ul>
            </nav>
          </div>
          <!-- Theme toggle copy-pasted BS -->
          <div
            class="theme-toggle"
            title="Dark mode"
            style="align-content:center"
            onclick="theme_toggle(this)"
          >
            <span class="theme-toggle-sr">Toggle theme</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
              class="theme-toggle__within"
              height="1em"
              width="1em"
              viewBox="0 0 32 32"
              fill="currentColor"
            >
              <clipPath id="theme-toggle__within__clip">
                <path d="M0 0h32v32h-32ZM6 16A1 1 0 0026 16 1 1 0 006 16" />
              </clipPath>
              <g clip-path="url(#theme-toggle__within__clip)">
                <path
                  d="M30.7 21.3 27.1 16l3.7-5.3c.4-.5.1-1.3-.6-1.4l-6.3-1.1-1.1-6.3c-.1-.6-.8-.9-1.4-.6L16 5l-5.4-3.7c-.5-.4-1.3-.1-1.4.6l-1 6.3-6.4 1.1c-.6.1-.9.9-.6 1.3L4.9 16l-3.7 5.3c-.4.5-.1 1.3.6 1.4l6.3 1.1 1.1 6.3c.1.6.8.9 1.4.6l5.3-3.7 5.3 3.7c.5.4 1.3.1 1.4-.6l1.1-6.3 6.3-1.1c.8-.1 1.1-.8.7-1.4zM16 25.1c-5.1 0-9.1-4.1-9.1-9.1 0-5.1 4.1-9.1 9.1-9.1s9.1 4.1 9.1 9.1c0 5.1-4 9.1-9.1 9.1z"
                />
              </g>
              <path
                class="theme-toggle__within__circle"
                d="M16 7.7c-4.6 0-8.2 3.7-8.2 8.2s3.6 8.4 8.2 8.4 8.2-3.7 8.2-8.2-3.6-8.4-8.2-8.4zm0 14.4c-3.4 0-6.1-2.9-6.1-6.2s2.7-6.1 6.1-6.1c3.4 0 6.1 2.9 6.1 6.2s-2.7 6.1-6.1 6.1z"
              />
              <path
                class="theme-toggle__within__inner"
                d="M16 9.5c-3.6 0-6.4 2.9-6.4 6.4s2.8 6.5 6.4 6.5 6.4-2.9 6.4-6.4-2.8-6.5-6.4-6.5z"
              />
            </svg>
          </div>
          <!-- kkk -->
        </div>
      </div>
    </footer>
    <script js>
      document.addEventListener("DOMContentLoaded", () => {
        let html = document.documentElement;
        const savedTheme = localStorage.getItem("theme") || "light";
        html.setAttribute("data-theme", savedTheme);
      });
      function theme_toggle(button) {
        button.classList.toggle("theme-toggle--toggled");
        let html = document.documentElement;
        let theme = html.getAttribute("data-theme");
        let newTheme = theme === "dark" ? "light" : "dark";
        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
      }
    </script>
  </body>
</html>
